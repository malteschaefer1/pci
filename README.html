<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PCI Circularity Calculator – README</title>
    <link rel="stylesheet" href="assets/css/styles.css" />
    <style>
      body {
        background: #f6f7fb;
      }
      main {
        max-width: 900px;
        margin: 2rem auto;
      }
      article {
        background: #fff;
        padding: 2rem;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(15, 23, 42, 0.05);
      }
      pre {
        padding: 1rem;
        background: #0f172a;
        color: #f8fafc;
        border-radius: 10px;
        overflow-x: auto;
      }
      code {
        font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
        background: rgba(15, 23, 42, 0.08);
        padding: 0 0.25rem;
        border-radius: 4px;
      }
      pre code {
        background: transparent;
        padding: 0;
      }
      a {
        color: #3c7dff;
      }
    </style>
  </head>
  <body>
    <header class="page-header">
      <div>
        <p class="eyebrow">Documentation</p>
        <h1>PCI Circularity Calculator – README</h1>
        <p>This page renders the Markdown documentation with full formatting for comfortable reading.</p>
        <div class="link-row">
          <a href="index.html">Back to the tool</a>
          <span aria-hidden="true">•</span>
          <a href="README.md" download>Download raw README.md</a>
        </div>
      </div>
    </header>
    <main>
      <article id="readme-content">
        <p>Loading README content…</p>
      </article>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="assets/js/readme-data.js"></script>
    <script>
      // Render the Markdown README, preferring the offline-embedded copy.
      document.addEventListener("DOMContentLoaded", () => {
        const container = document.getElementById("readme-content");
        const renderMarkdown = (markdown) => {
          container.innerHTML = marked.parse(markdown, { mangle: false, headerIds: false });
        };
        if (window.__PCI_README__) {
          renderMarkdown(window.__PCI_README__);
          return;
        }
        if (window.location.protocol === "file:") {
          container.innerHTML =
            '<p style="color:#c0392b;">Offline README not embedded. Run <code>python3 scripts/build-readme.py</code> and reload.</p>';
          return;
        }
        fetch("README.md")
          .then((response) => {
            if (!response.ok) throw new Error("Failed to fetch README.md");
            return response.text();
          })
          .then(renderMarkdown)
          .catch((error) => {
            container.innerHTML = `<p style="color:#c0392b;">Unable to load README.md. ${error.message}</p>`;
          });
      });
    </script>
  </body>
</html>
